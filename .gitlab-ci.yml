image: python:2.7

stages:
- Build
- Test
- Document

cmake:
    stage: Build
    script:
    - apt-get update -qq & & apt-get install -y -qq cmake
    - mkdir build && cd build
    - cmake -f ..
    - make all
    artifacts:
        paths:
        - bin/
        - lib/

cpp-unittest:
    stage: Test
    script:
    - apt-get update -qq & & apt-get install -y -qq cmake
    - mkdir build && cd build
    - cmake -f ..
    - make test

python-unittest:
    stage: Test
    script:
    - pip install -r requirements.txt
    - python reactor test -c

doxygen:
    stage: Document
    script:
    - apt-get update -qq & & apt-get install -y -qq doxygen
    - doxygen Doxyfile
    artifacts:
        paths:
        - doc